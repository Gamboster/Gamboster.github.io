<html>

<head>
  <title>Wyre widget</title>
</head>

<body>
  <button id='buy'>Buy</button>
  <div id="wyre-dropin-widget-container"></div>

  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://verify.sendwyre.com/js/verify-module-init-beta.js"></script>
  <script type="text/javascript">
    (function ($) {

      // debit card popup
      var widget = new Wyre({
        env: 'test',
        accountId: 'AC_JCR3UCENZTC',
        operation: {
          type: 'debitcard-hosted-dialog',
          dest: "n1kwe8jSMwMh2San4SKMVJxYBaw1cvjXXA",
          destCurrency: "BTC",
          paymentMethod: 'debit-card'
        }
      });

      console.log('######################');
      console.log(JSON.stringify(widget));
      console.log('######################');

      widget.on("exit", (e) => {
        console.log("exit", e);
      });

      widget.on("error", (e) => {
        console.log("error", e);
      });

      widget.on("complete", (e) => {
        console.log("complete", e);
      });

      widget.on("paymentSuccess", (e) => {
        console.log("paymentSuccess", e);
      });

      widget.on("close", (e) => {
        console.log("close", e);
      });

      widget.on('ready', (e) => {
        console.log("ready", e);
        // widget.open();
      });

      // "loadstart" | "loadstop" | "loaderror" | "exit" | "message"

      window.addEventListener("loadstart", (e) => {
        console.log("loadstart", e);
      });

      window.addEventListener("loadstop", (e) => {
        console.log("loadstop", e);
      });

      window.addEventListener("loaderror", (e) => {
        console.log("loaderror", e);
      });

      window.addEventListener("exit", (e) => {
        console.log("exit", e);
      });

      window.addEventListener("message", (e) => {
        console.log("message", e);
      });

      window.addEventListener('complete', (e) => {
        console.log("complete", e);
        // widget.open();
      });

      $('#buy').click(function () {
        console.log('open')
        widget.open();
      })

    })(jQuery);


  </script>
</body>

</html>